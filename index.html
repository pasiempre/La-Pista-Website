<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LaPista.ATX - Austin Pickup Soccer</title>
<meta name="description" content="Join Austin's premier pickup soccer community. Weekly games at quality fields, all skill levels welcome. Austin's most affordable pickup soccer.">
<meta name="keywords" content="pickup soccer, Austin TX, soccer games, futbol, LaPista, recreational soccer">
<meta property="og:title" content="LaPista.ATX - Austin Pickup Soccer">
<meta property="og:description" content="Weekly pickup games for all skill levels. Join 500+ players in Austin's soccer community.">
<meta property="og:image" content="/LaPista Logo 1.png">
<meta property="og:type" content="website">
<!-- TODO: Update og:url to your actual production domain -->
<meta property="og:url" content="https://lapista-atx.com">
<meta name="twitter:card" content="summary_large_image">
<meta name="theme-color" content="#18181b">
<link rel="icon" type="image/png" href="/LaPista Logo 1.png">
<link rel="apple-touch-icon" href="/LaPista Logo 1.png">
<link rel="manifest" href="/manifest.json">
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://code.iconify.design/3/3.1.0/iconify.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;600;700&amp;family=Space+Grotesk:wght@300;400;500;600;700&amp;display=swap" rel="stylesheet">
<link rel="stylesheet" href="/css/styles.css">
<script src="/js/config.js"></script>
<script src="/js/translations.js"></script>
<script src="/js/i18n.js"></script>
<script src="/js/auth.js"></script>

<!-- Google Analytics - Uncomment and add your GA4 ID when ready -->
<!-- 
<script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-XXXXXXXXXX');
</script>
-->

<!-- Alternative: Plausible Analytics (privacy-friendly) - Uncomment when ready -->
<!-- <script defer data-domain="lapista.atx" src="https://plausible.io/js/script.js"></script> -->

<!-- JSON-LD Structured Data for SEO -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "SportsOrganization",
  "name": "LaPista.ATX",
  "alternateName": "LaPista ATX",
  "url": "https://lapista-atx.com",
  "logo": "https://lapista-atx.com/LaPista Logo 1.png",
  "description": "Austin's premier pickup soccer community. Weekly games for all skill levels.",
  "address": {
    "@type": "PostalAddress",
    "addressLocality": "Austin",
    "addressRegion": "TX",
    "addressCountry": "US"
  },
  "sameAs": [
    "https://www.instagram.com/lapista.atx"
  ],
  "sport": "Soccer",
  "foundingDate": "2025",
  "areaServed": {
    "@type": "City",
    "name": "Austin",
    "containedInPlace": {
      "@type": "State",
      "name": "Texas"
    }
  }
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": "LaPista.ATX",
  "url": "https://lapista-atx.com",
  "potentialAction": {
    "@type": "SearchAction",
    "target": "https://lapista-atx.com/?search={search_term_string}",
    "query-input": "required name=search_term_string"
  }
}
</script>

</head>
  <body class="overflow-hidden flex antialiased text-base text-zinc-900 bg-[#FAFAFA] h-screen bg-noise">
    <div id="mobile-menu-overlay" class="fixed inset-0 bg-zinc-900/60 backdrop-blur-sm z-40 hidden transition-opacity duration-300" onclick="toggleMobileMenu()"></div>
    <aside id="mobile-menu-panel" class="fixed top-0 left-0 bottom-0 w-[300px] bg-zinc-900 z-50 transform -translate-x-full transition-transform duration-300 ease-out border-r border-zinc-800 flex flex-col shadow-2xl">
      <div class="flex items-center justify-between p-6 border-b border-zinc-800">
        <span class="font-display font-bold text-2xl text-white uppercase italic tracking-tighter">
          LaPista
          <span class="text-green-500">.ATX</span>
        </span>
        <button onclick="toggleMobileMenu()" class="text-zinc-500 hover:text-white transition-colors">
          <span class="iconify text-2xl" data-icon="lucide:x"></span>
        </button>
      </div>
      <div class="flex-1 overflow-y-auto p-6 flex flex-col gap-8">
        <nav class="flex flex-col gap-4">
          <a href="index.html#schedule" class="text-3xl font-black text-white uppercase italic font-display tracking-tight hover:text-green-500 transition-colors" data-i18n="nav.games">
            Games
          </a>
          <a href="about-page.html" class="text-3xl font-black text-white uppercase italic font-display tracking-tight hover:text-green-500 transition-colors" data-i18n="nav.about">
            About
          </a>
          <a href="faq-page.html" class="text-3xl font-black text-white uppercase italic font-display tracking-tight hover:text-green-500 transition-colors" data-i18n="nav.faq">
            FAQ
          </a>
          <a href="contact-page.html" class="text-3xl font-black text-white uppercase italic font-display tracking-tight hover:text-green-500 transition-colors" data-i18n="nav.contact">
            Contact
          </a>
        </nav>
        <div>
          <div class="text-[10px] font-bold text-zinc-500 uppercase tracking-widest mb-4" data-i18n="footer.venues">
            Venues
          </div>
          <ul class="flex flex-col gap-3">
            <li>
              <a href="#schedule" class="text-sm font-bold text-zinc-300 hover:text-green-500 uppercase tracking-wide flex items-center gap-2">
                <span class="iconify" data-icon="lucide:map-pin" data-width="14"></span>
                Shady Lane
              </a>
            </li>
            <li>
              <a href="#schedule" class="text-sm font-bold text-zinc-300 hover:text-green-500 uppercase tracking-wide flex items-center gap-2">
                <span class="iconify" data-icon="lucide:map-pin" data-width="14"></span>
                Cesar Chavez
              </a>
            </li>
            <li>
              <a href="#schedule" class="text-sm font-bold text-zinc-300 hover:text-green-500 uppercase tracking-wide flex items-center gap-2">
                <span class="iconify" data-icon="lucide:map-pin" data-width="14"></span>
                Prairie Lane
              </a>
            </li>
          </ul>
        </div>
        <div class="border-t border-zinc-800 pt-8 mt-auto">
          <div class="flex gap-4 flex-wrap">
            <a href="https://www.instagram.com/lapista.atx" target="_blank" class="w-10 h-10 rounded bg-zinc-800 flex items-center justify-center text-zinc-400 hover:bg-green-600 hover:text-white transition-all">
              <span class="iconify text-xl" data-icon="lucide:instagram" data-width="20"></span>
            </a>
            <a href="https://chat.whatsapp.com/Gqkat9jvT1cAVURDjR9DqA" target="_blank" class="w-10 h-10 rounded bg-zinc-800 flex items-center justify-center text-zinc-400 hover:bg-green-600 hover:text-white transition-all">
              <span class="iconify text-xl" data-icon="mdi:whatsapp" data-width="20"></span>
            </a>
            <a href="https://www.facebook.com/groups/868317082761568" target="_blank" class="w-10 h-10 rounded bg-zinc-800 flex items-center justify-center text-zinc-400 hover:bg-green-600 hover:text-white transition-all">
              <span class="iconify text-xl" data-icon="mdi:facebook" data-width="20"></span>
            </a>
            <a href="https://www.tiktok.com/@lapista.atx" target="_blank" class="w-10 h-10 rounded bg-zinc-800 flex items-center justify-center text-zinc-400 hover:bg-green-600 hover:text-white transition-all">
              <span class="iconify text-xl" data-icon="ic:baseline-tiktok" data-width="20"></span>
            </a>
          </div>
        </div>
      </div>
    </aside>
    <!-- Sidebar -->

    <!-- Main Content Area -->
    <main class="flex-1 flex flex-col min-w-0 bg-[#FAFAFA]">
      <!-- Header -->
      <header class="h-16 border-b border-zinc-200 flex items-center justify-between shrink-0 bg-white/80 backdrop-blur-sm z-10 sticky top-0 px-3 md:px-5">
        <div class="flex items-center gap-3">
          <!-- Mobile Menu Button -->
          <button class="lg:hidden text-zinc-500" onclick="toggleMobileMenu()">
            <span class="iconify text-2xl" data-icon="lucide:menu" data-width="1.5"></span>
          </button>
          <a href="index.html" class="flex items-center group">
            <img src="/LaPista Logo 1.png" alt="LaPista Logo" class="h-[50px] w-[50px] object-contain group-hover:scale-110 transition-transform">
          </a>
          </div>

        <div class="flex items-center gap-6">
          <div class="hidden md:flex items-center gap-3">
            <div class="text-right">
              <div class="text-[10px] text-green-600 font-black uppercase tracking-widest">
                THIS WEEK
              </div>
              <div id="week-range" class="text-sm font-bold text-zinc-900 uppercase font-display">
                <!-- Dynamically set -->
              </div>
            </div>
          </div>

          <div class="flex -space-x-2 hidden sm:flex">
            <div class="w-9 h-9 rounded-md border-2 border-white bg-green-500 flex items-center justify-center text-xs font-bold text-white shadow-sm">
              <span class="iconify" data-icon="lucide:user" data-width="16"></span>
            </div>
            <div class="w-9 h-9 rounded-md border-2 border-white bg-green-600 flex items-center justify-center text-xs font-bold text-white shadow-sm">
              <span class="iconify" data-icon="lucide:user" data-width="16"></span>
            </div>
            <div class="w-9 h-9 rounded-md border-2 border-white bg-green-700 flex items-center justify-center text-xs font-bold text-white shadow-sm">
              <span class="iconify" data-icon="lucide:user" data-width="16"></span>
            </div>
            <div id="player-count-badge" class="w-9 h-9 rounded-md border-2 border-white bg-zinc-900 flex items-center justify-center text-xs font-bold text-white cursor-pointer shadow-sm hover:bg-green-600 transition-colors" title="Players joined this week">
              <span class="iconify animate-pulse" data-icon="lucide:loader-2" data-width="14"></span>
            </div>
          </div>

          <button onclick="scrollToSchedule()" class="bg-zinc-900 hover:bg-green-600 text-white text-sm font-bold px-5 py-2 rounded-md transition-all flex items-center gap-2 shadow-sm uppercase tracking-wide group">
            <span class="iconify group-hover:text-white text-green-400" data-icon="lucide:calendar" data-width="1.5"></span>
            <span data-i18n="hero.cta">FIND A GAME</span>
          </button>

          <!-- Auth Button (shown when logged out) -->
          <a href="login-page.html" data-auth-button class="flex items-center gap-2 px-3 py-2 rounded-md border border-zinc-200 bg-white hover:bg-zinc-50 hover:border-green-500 text-zinc-600 hover:text-green-600 transition-all group" aria-label="Sign in or create account" title="Sign in or create a free account">
            <span class="iconify" data-icon="lucide:user" data-width="18"></span>
            <span class="hidden sm:inline text-xs font-bold uppercase tracking-wide group-hover:text-green-600">Join</span>
          </a>

          <!-- User Menu (shown when logged in) -->
          <a href="profile-page.html" data-user-menu class="hidden w-9 h-9 rounded-md bg-green-600 hover:bg-green-700 flex items-center justify-center text-xs font-bold text-white transition-all" aria-label="View profile">
            <span data-user-initials>--</span>
          </a>
        </div>
      </header>

      <!-- Content Wrapper -->
      <div class="flex-1 flex overflow-hidden relative">
        <!-- Board View -->
        <div class="flex-1 flex flex-col min-w-0">
          <!-- Toolbar -->

          <!-- Kanban Board -->
          <div id="main-scroll-container" class="flex-1 overflow-x-hidden overflow-y-auto px-4 md:px-6 pb-6 bg-[#FAFAFA]">
            <div class="relative w-full py-24 flex flex-col items-center justify-center text-center mb-16 overflow-hidden bg-zinc-900 text-white">
              <!-- Background image -->
              <div class="absolute inset-0 bg-cover bg-center bg-no-repeat opacity-30" style="background-image: url('/images/background.png');"></div>
              <div class="absolute inset-0 bg-gradient-to-t from-zinc-900 via-zinc-900/70 to-zinc-900/50"></div>
              <div class="relative z-10 max-w-3xl px-6">
                <span class="inline-block py-1.5 px-4 rounded-full bg-green-500/10 text-green-400 text-xs font-black uppercase tracking-widest mb-6 border border-green-500/20" data-i18n="hero.tagline">
                  AUSTIN'S PICKUP SOCCER
                </span>
                <h1 class="text-7xl md:text-9xl font-black uppercase italic tracking-tighter mb-6 font-display leading-[0.85]">
                  PURO
                  <span class="text-green-500">FÃšTBOL</span>
                </h1>
                <p class="text-xl text-zinc-400 font-medium max-w-lg mx-auto mb-10 leading-relaxed" data-i18n="hero.description">
                  Austin's most affordable pickup soccer. Weekly games at quality fields, all skill levels welcome.
                </p>
                <div class="flex flex-col sm:flex-row items-center justify-center gap-4">
                  <button onclick="scrollToSchedule()" class="px-8 py-4 bg-green-500 hover:bg-green-600 text-white font-black uppercase tracking-wide rounded-md transition-all shadow-lg shadow-green-900/20 transform hover:-translate-y-1" data-i18n="hero.cta">
                    FIND A GAME
                  </button>
                  <a href="about-page.html" class="px-8 py-4 bg-zinc-800 hover:bg-zinc-700 text-white font-black uppercase tracking-wide rounded-md transition-all border border-zinc-700" data-i18n="hero.learnMore">
                    HOW IT WORKS
                  </a>
                </div>
                <!-- Sign-up prompt for new visitors -->
                <p class="mt-6 text-sm text-zinc-500">
                  <a href="login-page.html" class="text-green-400 hover:text-green-300 font-semibold underline underline-offset-2">Create a free account</a>
                  to book faster & track your games
                </p>
              </div>
            </div>

            <div class="max-w-7xl mx-auto px-4 md:px-6 mb-8">
              <!-- Section Header: Title + Count + Live Chip -->
              <div class="flex items-center gap-3 mb-4 pt-2" id="schedule">
                <span class="text-3xl font-black text-zinc-900 uppercase tracking-tighter font-display italic">
                  LIVE & UPCOMING
                </span>
                <span id="games-count" class="text-lg font-bold text-zinc-500 font-display">
                  (Loading...)
                </span>
                <span id="live-chip" class="hidden px-2 py-0.5 rounded text-[10px] font-black bg-blue-500 text-white uppercase tracking-wider transform -skew-x-12 animate-pulse">
                  <!-- Updated dynamically: "2 LIVE NOW" -->
                </span>
              </div>
              <!-- Status Filter Chips -->
              <div class="flex items-center gap-2 py-2">
                <div id="status-filter-buttons" class="flex items-center gap-1 flex-wrap">
                  <button data-status="all" class="status-btn px-3 py-1 text-xs font-bold uppercase bg-zinc-900 text-white rounded-full transition-all">All</button>
                  <button data-status="bookable" class="status-btn px-3 py-1 text-xs font-bold uppercase text-zinc-500 hover:bg-green-50 hover:text-green-700 rounded-full transition-all flex items-center gap-1">
                    <span class="iconify" data-icon="lucide:ticket" data-width="12"></span>Bookable
                  </button>
                  <button data-status="live" class="status-btn px-3 py-1 text-xs font-bold uppercase text-zinc-500 hover:bg-blue-50 hover:text-blue-700 rounded-full transition-all flex items-center gap-1">
                    <span class="iconify" data-icon="lucide:radio" data-width="12"></span>Live
                  </button>
                  <button data-status="full" class="status-btn px-3 py-1 text-xs font-bold uppercase text-zinc-500 hover:bg-amber-50 hover:text-amber-700 rounded-full transition-all flex items-center gap-1">
                    <span class="iconify" data-icon="lucide:users" data-width="12"></span>Full
                  </button>
                </div>
              </div>
              <!-- Region Filters + Search Row -->
              <div class="flex flex-col md:flex-row items-center justify-between gap-4 py-3 border-y border-zinc-200 bg-white/50 backdrop-blur-sm sticky top-0 z-20">
                <div class="flex items-center gap-2">
                  <span class="iconify text-green-600" data-icon="lucide:map-pin" data-width="18"></span>
                  <div id="filter-buttons" class="flex items-center gap-1">
                    <button data-region="all" class="filter-btn px-3 py-1 text-xs font-bold uppercase bg-zinc-900 text-white rounded transition-all" data-i18n="filter.all">
                      ALL
                    </button>
                    <button data-region="south" class="filter-btn px-3 py-1 text-xs font-bold uppercase text-zinc-500 hover:bg-zinc-200 rounded transition-all" data-i18n="filter.south">
                      SOUTH
                    </button>
                    <button data-region="east" class="filter-btn px-3 py-1 text-xs font-bold uppercase text-zinc-500 hover:bg-zinc-200 rounded transition-all" data-i18n="filter.east">
                      EAST
                    </button>
                    <button data-region="north" class="filter-btn px-3 py-1 text-xs font-bold uppercase text-zinc-500 hover:bg-zinc-200 rounded transition-all" data-i18n="filter.north">
                      NORTH
                    </button>
                  </div>
                </div>
                <div class="relative w-full md:w-auto">
                  <span class="iconify absolute left-3 top-2.5 text-zinc-400" data-icon="lucide:search" data-width="16"></span>
                  <input id="game-search" type="text" data-i18n-placeholder="filter.search" placeholder="FIND A GAME..." class="w-full md:w-64 bg-white border border-zinc-200 rounded-md py-2 pl-9 pr-4 text-xs font-bold uppercase focus:outline-none focus:border-green-500 transition-all">
                </div>
              </div>
            </div>

            <!-- Loading State -->
            <div id="games-loading" class="flex flex-col items-center justify-center py-16 max-w-7xl mx-auto px-4 md:px-6">
              <div class="w-12 h-12 border-4 border-zinc-200 border-t-green-500 rounded-full animate-spin mb-4"></div>
              <p class="text-zinc-500 font-medium" data-i18n="misc.loading">Loading games...</p>
            </div>

            <!-- Error State -->
            <div id="games-error" class="hidden flex flex-col items-center justify-center py-16 max-w-7xl mx-auto px-4 md:px-6">
              <div class="w-16 h-16 bg-red-50 rounded-full flex items-center justify-center mb-4">
                <span class="iconify text-red-500 text-3xl" data-icon="lucide:alert-circle"></span>
              </div>
              <p class="text-zinc-700 font-bold mb-2">Failed to load games</p>
              <button onclick="loadGames()" class="text-green-600 font-bold text-sm uppercase hover:underline">Try Again</button>
            </div>

            <!-- Dynamic Games Container -->
            <div id="games-container" class="hidden flex flex-col md:flex-row h-auto gap-6 w-full max-w-7xl mx-auto px-4 md:px-6 justify-center">
              <!-- Games will be loaded dynamically -->
            </div>
            <div class="py-24 border-t border-zinc-200 mt-20">
              <div class="max-w-6xl mx-auto px-6 grid grid-cols-1 md:grid-cols-2 gap-12 items-center">
                <div>
                  <h2 class="text-5xl font-black uppercase tracking-tighter italic mb-6 font-display" data-i18n="home.aboutTitle">
                    ABOUT LAPISTA
                  </h2>
                  <p class="text-zinc-600 text-lg mb-6 leading-relaxed" data-i18n="home.aboutPara1">
                    We started LaPista with a simple goal: to create the best
                    pickup soccer experience in Austin. Organized games, quality
                    fields, and a community that respects the game.
                  </p>
                  <p class="text-zinc-600 text-lg mb-8 leading-relaxed" data-i18n="home.aboutPara2">
                    Whether you're a former pro or just getting back into it,
                    there's a spot for you on the pitch.
                  </p>
                  <a href="about-page.html" class="inline-flex items-center gap-2 text-green-600 font-black uppercase tracking-wide hover:underline text-lg group">
                    <span data-i18n="home.learnMore">Learn More</span>
                    <span class="iconify group-hover:translate-x-1 transition-transform" data-icon="lucide:arrow-right"></span>
                  </a>
                </div>
                <div class="grid grid-cols-2 gap-4">
                  <div class="h-64 bg-zinc-900 rounded-lg overflow-hidden relative group">
                    <img src="/Game photo 1.png" alt="LaPista pickup soccer game" class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-500">
                  </div>
                  <div class="h-64 bg-zinc-900 rounded-lg overflow-hidden relative group translate-y-8">
                    <img src="/Game photo 2.png" alt="LaPista soccer community" class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-500">
                  </div>
                </div>
              </div>
            </div>

            <div class="py-24 bg-zinc-900 text-center text-white relative overflow-hidden">
              <div class="absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/carbon-fibre.png')] opacity-10"></div>
              <h2 class="text-5xl font-black uppercase tracking-tighter italic mb-12 font-display relative z-10" data-i18n="home.onThePitch">
                ON THE PITCH
              </h2>
              <div class="grid grid-cols-1 md:grid-cols-3 gap-6 max-w-6xl mx-auto px-6 relative z-10">
                <div class="aspect-[9/16] bg-zinc-800 rounded-xl border border-zinc-700 overflow-hidden group cursor-pointer hover:border-green-500 transition-colors relative">
                  <video class="w-full h-full object-cover" poster="/Game photo 1.png" playsinline muted loop onclick="this.paused ? this.play() : this.pause()">
                    <source src="/La Pista Highlights.mp4" type="video/mp4">
                  </video>
                  <div class="absolute inset-0 flex items-center justify-center bg-black/30 group-hover:bg-black/10 transition-colors pointer-events-none video-overlay">
                    <span class="iconify text-5xl text-white/80 group-hover:text-green-500 transition-colors" data-icon="lucide:play-circle"></span>
                  </div>
                </div>
                <div class="aspect-[9/16] bg-zinc-800 rounded-xl border border-zinc-700 overflow-hidden group cursor-pointer hover:border-green-500 transition-colors relative">
                  <video class="w-full h-full object-cover" poster="/Game photo 2.png" playsinline muted loop onclick="this.paused ? this.play() : this.pause()">
                    <source src="/North Austin 4v4 Futbol Video.mp4" type="video/mp4">
                  </video>
                  <div class="absolute inset-0 flex items-center justify-center bg-black/30 group-hover:bg-black/10 transition-colors pointer-events-none video-overlay">
                    <span class="iconify text-5xl text-white/80 group-hover:text-green-500 transition-colors" data-icon="lucide:play-circle"></span>
                  </div>
                </div>
                <div class="aspect-[9/16] bg-zinc-800 rounded-xl border border-zinc-700 overflow-hidden group cursor-pointer hover:border-green-500 transition-colors relative">
                  <video class="w-full h-full object-cover" poster="/Game photo 1.png" playsinline muted loop onclick="this.paused ? this.play() : this.pause()">
                    <source src="/NORTH%20AUSTIN%20%F0%9F%93%8DLa%20Pista%F0%9F%92%9A%E2%9A%BD%EF%B8%8F%20and%20%40fletchasoccerchamps%20%F0%9F%92%AB%20will%20be%20hosting%204v4%20games%20every%20thursday.mp4" type="video/mp4">
                  </video>
                  <div class="absolute inset-0 flex items-center justify-center bg-black/30 group-hover:bg-black/10 transition-colors pointer-events-none video-overlay">
                    <span class="iconify text-5xl text-white/80 group-hover:text-green-500 transition-colors" data-icon="lucide:play-circle"></span>
                  </div>
                </div>
              </div>
              <script>
                // Hide play overlay when video plays
                document.querySelectorAll('video').forEach(video => {
                  video.addEventListener('play', () => {
                    video.parentElement.querySelector('.video-overlay').style.opacity = '0';
                  });
                  video.addEventListener('pause', () => {
                    video.parentElement.querySelector('.video-overlay').style.opacity = '1';
                  });
                });
              </script>
            </div>

            <div class="py-24 max-w-6xl mx-auto w-full px-6">
              <div class="text-center mb-16">
                <h2 class="text-5xl font-black uppercase tracking-tighter italic mb-4 font-display" data-i18n="contact.title">
                  GET IN TOUCH
                </h2>
                <p class="text-zinc-500 text-lg" data-i18n="contact.subtitle">
                  Have a question? We'd love to hear from you.
                </p>
              </div>
              <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <a href="https://www.instagram.com/lapista.atx" target="_blank" class="flex flex-col items-center justify-center p-10 bg-white border border-zinc-200 rounded-xl hover:border-green-500 hover:shadow-xl transition-all group">
                  <span class="iconify text-4xl text-zinc-400 group-hover:text-green-600 mb-6 transition-colors" data-icon="lucide:instagram"></span>
                  <span class="font-bold text-xl text-zinc-900 mb-1">
                    @lapista.atx
                  </span>
                  <span class="text-xs text-zinc-400 font-bold uppercase tracking-wider" data-i18n="contact.followUs">
                    Follow Us
                  </span>
                </a>
                <a href="https://chat.whatsapp.com/Gqkat9jvT1cAVURDjR9DqA" target="_blank" class="flex flex-col items-center justify-center p-10 bg-white border border-zinc-200 rounded-xl hover:border-green-500 hover:shadow-xl transition-all group">
                  <span class="iconify text-4xl text-zinc-400 group-hover:text-green-600 mb-6 transition-colors" data-icon="mdi:whatsapp"></span>
                  <span class="font-bold text-xl text-zinc-900 mb-1" data-i18n="contact.whatsappGroup">
                    WhatsApp Group
                  </span>
                  <span class="text-xs text-zinc-400 font-bold uppercase tracking-wider" data-i18n="contact.joinChat">
                    Join Chat
                  </span>
                </a>
                <a href="mailto:lapista.atx@gmail.com" class="flex flex-col items-center justify-center p-10 bg-white border border-zinc-200 rounded-xl hover:border-green-500 hover:shadow-xl transition-all group">
                  <span class="iconify text-4xl text-zinc-400 group-hover:text-green-600 mb-6 transition-colors" data-icon="lucide:mail"></span>
                  <span class="font-bold text-xl text-zinc-900 mb-1">
                    lapista.atx@gmail.com
                  </span>
                  <span class="text-xs text-zinc-400 font-bold uppercase tracking-wider" data-i18n="contact.emailUs">
                    Email Us
                  </span>
                </a>
              </div>
            </div>

            <!-- Partnered With Section -->
            <section class="py-12 border-t border-zinc-200 bg-zinc-50">
              <div class="max-w-4xl mx-auto px-4 text-center">
                <p class="text-xs font-bold text-zinc-400 uppercase tracking-widest mb-6 font-display">
                  Partnered With
                </p>
                <a href="https://sphere.club" target="_blank" rel="noopener noreferrer" class="inline-block opacity-70 hover:opacity-100 transition-opacity">
                  <img src="/black/sphere-horz-R.png" alt="Sphere Soccer" class="h-48 md:h-56 object-contain mx-auto">
                </a>
              </div>
            </section>

            <footer class="bg-zinc-900 text-white pt-20 pb-10">
              <div class="max-w-7xl mx-auto px-6">
                <div class="grid grid-cols-1 md:grid-cols-4 gap-12 mb-16 border-b border-zinc-800 pb-16">
                  <div class="col-span-1">
                    <span class="font-display font-bold text-2xl tracking-tighter text-white">
                      LaPista
                      <span class="text-green-500">.ATX</span>
                    </span>
                    <p class="text-zinc-500 text-sm mt-6 leading-relaxed" data-i18n="footer.tagline">
                      Connecting Austin's soccer community, one game at a time.
                    </p>
                  </div>
                  <div class="col-span-1">
                    <h4 class="font-bold uppercase tracking-widest text-xs text-zinc-500 mb-6" data-i18n="footer.explore">
                      Explore
                    </h4>
                    <ul class="space-y-4 text-sm font-medium text-zinc-400">
                      <li>
                        <a href="index.html#schedule" class="hover:text-green-500 transition-colors" data-i18n="nav.games">
                          Games
                        </a>
                      </li>
                      <li>
                        <a href="about-page.html" class="hover:text-green-500 transition-colors" data-i18n="nav.about">
                          About
                        </a>
                      </li>
                      <li>
                        <a href="index.html#schedule" class="hover:text-green-500 transition-colors" data-i18n="footer.venues">
                          Venues
                        </a>
                      </li>
                    </ul>
                  </div>
                  <div class="col-span-1">
                    <h4 class="font-bold uppercase tracking-widest text-xs text-zinc-500 mb-6" data-i18n="footer.support">
                      Support
                    </h4>
                    <ul class="space-y-4 text-sm font-medium text-zinc-400">
                      <li>
                        <a href="faq-page.html" class="hover:text-green-500 transition-colors" data-i18n="nav.faq">
                          FAQ
                        </a>
                      </li>
                      <li>
                        <a href="contact-page.html" class="hover:text-green-500 transition-colors" data-i18n="nav.contact">
                          Contact
                        </a>
                      </li>
                      <li>
                        <a href="terms.html" class="hover:text-green-500 transition-colors" data-i18n="footer.terms">
                          Terms
                        </a>
                      </li>
                    </ul>
                  </div>
                  <div class="col-span-1">
                    <h4 class="font-bold uppercase tracking-widest text-xs text-zinc-500 mb-6" data-i18n="footer.follow">
                      Follow
                    </h4>
                    <div class="flex gap-4 mb-6 flex-wrap">
                      <a href="https://www.instagram.com/lapista.atx" target="_blank" class="w-10 h-10 rounded bg-zinc-800 flex items-center justify-center text-zinc-400 hover:bg-green-600 hover:text-white transition-all">
                        <span class="iconify text-xl" data-icon="lucide:instagram" data-width="20"></span>
                      </a>
                      <a href="https://chat.whatsapp.com/Gqkat9jvT1cAVURDjR9DqA" target="_blank" class="w-10 h-10 rounded bg-zinc-800 flex items-center justify-center text-zinc-400 hover:bg-green-600 hover:text-white transition-all">
                        <span class="iconify text-xl" data-icon="mdi:whatsapp" data-width="20"></span>
                      </a>
                      <a href="https://www.facebook.com/groups/868317082761568" target="_blank" class="w-10 h-10 rounded bg-zinc-800 flex items-center justify-center text-zinc-400 hover:bg-green-600 hover:text-white transition-all">
                        <span class="iconify text-xl" data-icon="mdi:facebook" data-width="20"></span>
                      </a>
                      <a href="https://www.tiktok.com/@lapista.atx" target="_blank" class="w-10 h-10 rounded bg-zinc-800 flex items-center justify-center text-zinc-400 hover:bg-green-600 hover:text-white transition-all">
                        <span class="iconify text-xl" data-icon="ic:baseline-tiktok" data-width="20"></span>
                      </a>
                    </div>
                    <!-- Language Toggle in Footer -->
                    <div class="flex items-center gap-2">
                      <span class="iconify text-zinc-500" data-icon="lucide:globe" data-width="16"></span>
                      <button data-lang-toggle class="text-sm font-bold text-zinc-400 hover:text-green-500 transition-colors">
                        ES
                      </button>
                    </div>
                  </div>
                </div>
                <div class="flex flex-col md:flex-row justify-between items-center text-xs text-zinc-600 font-bold uppercase tracking-wide">
                  <div>Â© <span data-year>2026</span> LaPista.ATX</div>
                  <div class="flex gap-6 mt-4 md:mt-0">
                    <a href="terms.html" class="hover:text-zinc-400" data-i18n="footer.privacy">Privacy Policy</a>
                    <a href="terms.html" class="hover:text-zinc-400">Terms of Service</a>
                  </div>
                </div>
              </div>
            </footer>
          </div>
        </div>

        <!-- Right Sidebar (Details Panel) -->
        <aside class="w-[400px] bg-white border-l border-zinc-200 overflow-y-auto hidden xl:flex flex-col shrink-0 z-20 shadow-[-4px_0_15px_-3px_rgba(0,0,0,0.05)]">
          <!-- Header -->
          <div class="h-14 flex items-center justify-between px-6 border-b border-zinc-100 shrink-0 bg-zinc-50">
            <span class="text-xs font-bold text-zinc-500 uppercase tracking-wide">
              GAME DETAILS
            </span>
            <button class="text-zinc-400 hover:text-red-500 transition-colors">
              <span class="iconify text-2xl" data-icon="lucide:x-square" data-width="1.5"></span>
            </button>
          </div>

          <div class="p-6">
            <div class="mb-6">
              <div class="text-4xl font-black text-zinc-900 tracking-tighter leading-none font-display uppercase italic mb-1" id="sidebar-title">
                SUNDAY PICKUP
              </div>
              <div class="text-lg font-bold text-zinc-500 font-display" id="sidebar-date">
                JANUARY 5, 2025
              </div>
            </div>

            <!-- Properties Grid -->
            <div class="grid grid-cols-[100px_1fr] gap-y-5 text-sm mb-8">
              <div class="text-zinc-400 font-bold uppercase text-xs tracking-wide pt-1">
                VENUE
              </div>
              <div class="flex items-start gap-2 text-zinc-900 font-bold leading-tight">
                <span class="iconify text-green-600 mt-0.5 shrink-0" data-icon="lucide:map-pin" data-width="1.5"></span>
                <span id="sidebar-venue">
                  Loading venue...
                </span>
              </div>
              <div class="text-zinc-400 font-bold uppercase text-xs tracking-wide pt-1">
                TIME
              </div>
              <div id="sidebar-time" class="text-zinc-900 font-bold font-mono text-sm">
                --:-- PM
              </div>
              <div class="text-zinc-400 font-bold uppercase text-xs tracking-wide pt-1">
                PRICE
              </div>
              <div class="text-green-600 font-black text-sm">
                <span id="sidebar-price">$5.99</span>
                <span class="text-zinc-400 font-medium">per person</span>
              </div>
              <div class="text-zinc-400 font-bold uppercase text-xs tracking-wide pt-1">
                SPOTS
              </div>
              <div class="w-full">
                <div class="flex justify-between text-xs font-bold mb-1">
                  <span id="sidebar-filled" class="text-zinc-900">0 FILLED</span>
                  <span id="sidebar-total" class="text-zinc-400">24 TOTAL</span>
                </div>
                <div class="h-2 w-full bg-zinc-100 rounded-full overflow-hidden">
                  <div id="sidebar-progress" class="h-full bg-green-500 w-0 transition-all duration-300"></div>
                </div>
              </div>
              <div class="text-zinc-400 font-bold uppercase text-xs tracking-wide pt-1">
                LEVEL
              </div>
              <div>
                <span class="inline-flex items-center px-2 py-0.5 rounded bg-zinc-100 text-zinc-700 border border-zinc-200 text-[10px] font-black uppercase tracking-wide">
                  OPEN TO ALL
                </span>
              </div>
              <div class="col-span-2 border-t border-dashed border-zinc-200 my-2"></div>
              <div class="text-zinc-400 font-bold uppercase text-xs tracking-wide pt-1">
                PAYMENT
              </div>
              <div class="flex gap-2">
                <span class="inline-flex items-center px-2 py-0.5 rounded border border-green-500 text-green-600 bg-white text-[10px] font-black uppercase tracking-wide">
                  PAY ONLINE
                </span>
                <span class="inline-flex items-center px-2 py-0.5 rounded border border-zinc-300 text-zinc-500 bg-white text-[10px] font-black uppercase tracking-wide">
                  PAY AT GAME
                </span>
              </div>
            </div>

            <!-- Description -->
            <div class="mb-8 bg-zinc-50 p-4 rounded-md border border-zinc-100">
              <h4 class="text-xs font-black text-zinc-400 uppercase tracking-widest mb-3 font-display">
                WHAT TO EXPECT
              </h4>
              <div class="text-zinc-700 text-sm leading-relaxed space-y-2 font-medium">
                <ul class="list-disc list-inside text-zinc-500 pl-1 text-xs space-y-1">
                  <li>Bring a white and dark shirt</li>
                  <li>Arrive 10 min early</li>
                  <li>All skill levels welcome</li>
                  <li>Water available on site</li>
                </ul>
              </div>
            </div>
            <!-- Quick RSVP CTA -->
            <div class="mb-8 border-t border-dashed border-zinc-200 pt-6">
              <div class="bg-green-50 border border-green-200 rounded-lg p-6 text-center">
                <div class="relative w-12 h-12 mx-auto mb-4">
                  <!-- Animated pulsing ring -->
                  <span class="absolute inset-0 rounded-full bg-green-400 animate-ping opacity-30"></span>
                  <span class="absolute inset-1 rounded-full bg-green-300 animate-pulse opacity-40"></span>
                  <!-- Static icon -->
                  <div class="relative w-12 h-12 bg-green-100 rounded-full flex items-center justify-center">
                    <span class="iconify text-green-600 text-2xl" data-icon="lucide:calendar-check" data-width="1.5"></span>
                  </div>
                </div>
                <h4 class="text-lg font-black text-zinc-900 uppercase tracking-tight font-display mb-2">
                  Ready to Play?
                </h4>
                <p class="text-sm text-zinc-500 mb-4">
                  Reserve your spot in just a few clicks. Add guests and choose your payment method.
                </p>
                <a id="sidebar-rsvp-btn" href="game-details.html?gameId=LP-001" class="block w-full py-3 bg-green-600 hover:bg-green-700 text-white font-bold uppercase tracking-wide rounded shadow-sm transition-all text-sm text-center">
                  <span class="iconify inline-block mr-2" data-icon="lucide:ticket" data-width="1.2"></span>
                  Book This Game
                </a>
                <p class="text-[10px] text-zinc-400 mt-3 font-medium">
                  Pay online or at the game â€¢ Add up to 4 guests
                </p>
              </div>
            </div>

            <div class="pt-4 border-t border-dashed border-zinc-200 text-center">
              <a id="sidebar-details-link" href="game-details.html?gameId=LP-001" class="inline-flex items-center gap-1.5 text-xs font-black text-zinc-400 hover:text-green-600 uppercase tracking-widest transition-colors group">
                View Full Details
                <span class="iconify group-hover:translate-x-1 transition-transform" data-icon="lucide:arrow-right"></span>
              </a>
            </div>
          </div>
        </aside>
      </div>
    </main>

    <script>
      function toggleMobileMenu(){const e=document.getElementById("mobile-menu-overlay"),t=document.getElementById("mobile-menu-panel");e.classList.toggle("hidden"),t.classList.toggle("-translate-x-full")}
      
      function scrollToSchedule() {
        const container = document.getElementById('main-scroll-container');
        const target = document.getElementById('schedule');
        if (container && target) {
          const rect = target.getBoundingClientRect();
          const containerRect = container.getBoundingClientRect();
          container.scrollBy({ top: rect.top - containerRect.top - 20, behavior: 'smooth' });
        }
      }
    </script>

    <script>
      // Use shared configuration with fallback
      const API_URL = (typeof LAPISTA_CONFIG !== 'undefined' && LAPISTA_CONFIG.API_URL) 
        ? LAPISTA_CONFIG.API_URL 
        : (window.location.hostname === 'localhost' ? 'http://localhost:3001' : '');

      // Calculate and display current week range
      function updateWeekRange() {
        const now = new Date();
        const dayOfWeek = now.getDay(); // 0 = Sunday
        const mondayOffset = dayOfWeek === 0 ? -6 : 1 - dayOfWeek;
        const monday = new Date(now);
        monday.setDate(now.getDate() + mondayOffset);
        const sunday = new Date(monday);
        sunday.setDate(monday.getDate() + 6);
        
        const months = ['JAN', 'FEB', 'MAR', 'APR', 'MAY', 'JUN', 'JUL', 'AUG', 'SEP', 'OCT', 'NOV', 'DEC'];
        const startMonth = months[monday.getMonth()];
        const endMonth = months[sunday.getMonth()];
        
        const rangeText = startMonth === endMonth 
          ? `${startMonth} ${monday.getDate()} - ${sunday.getDate()}`
          : `${startMonth} ${monday.getDate()} - ${endMonth} ${sunday.getDate()}`;
        
        const el = document.getElementById('week-range');
        if (el) el.textContent = rangeText;
      }
      updateWeekRange();

      // Format day for display - use stored dayOfWeek to avoid timezone issues
      function formatGameDay(game) {
        // Prefer the stored dayOfWeek field (avoids timezone conversion issues)
        if (game.dayOfWeek) {
          const dayMap = {
            'Sunday': 'Sun', 'Monday': 'Mon', 'Tuesday': 'Tue', 
            'Wednesday': 'Wed', 'Thursday': 'Thu', 'Friday': 'Fri', 'Saturday': 'Sat',
            'Sun': 'Sun', 'Mon': 'Mon', 'Tue': 'Tue', 
            'Wed': 'Wed', 'Thu': 'Thu', 'Fri': 'Fri', 'Sat': 'Sat'
          };
          return dayMap[game.dayOfWeek] || game.dayOfWeek.slice(0, 3);
        }
        // Fallback to calculating from date (use UTC components to avoid day shift)
        const date = gameLocalDate(game.date);
        return date.toLocaleDateString('en-US', { weekday: 'short' });
      }

      // Create game card HTML â€” redesigned with time as primary, status badges
      function createGameCard(game, isHot = false) {
        const capacity = game.capacity || 24;
        const spotsRemaining = Math.max(0, Math.min(game.spotsRemaining, capacity));
        const filled = capacity - spotsRemaining;
        const fillPercent = Math.round((filled / capacity) * 100);
        const isFull = spotsRemaining === 0;
        const liveStatus = getGameLiveStatus(game);
        
        const venueName = game.venue?.name?.replace(' Fields', '') || 'TBD';

        // Status-based styling
        let borderClass, bgClass, badgeHtml, ctaText, ctaClass;
        
        switch (liveStatus) {
          case 'in-progress':
            borderClass = 'border-2 border-blue-400';
            bgClass = 'bg-blue-50/30';
            badgeHtml = '<span class="text-[10px] font-bold text-white bg-blue-500 px-1.5 py-0.5 rounded uppercase tracking-wide flex items-center gap-1 animate-pulse"><span class="iconify" data-icon="lucide:radio" data-width="10"></span>IN PROGRESS</span>';
            ctaText = 'View Game â†’';
            ctaClass = 'text-blue-600';
            break;
          case 'starting-soon':
            borderClass = 'border-2 border-orange-400';
            bgClass = '';
            badgeHtml = '<span class="text-[10px] font-bold text-white bg-orange-500 px-1.5 py-0.5 rounded uppercase tracking-wide flex items-center gap-1"><span class="iconify" data-icon="lucide:clock" data-width="10"></span>STARTING SOON</span>';
            ctaText = isFull ? 'Join Waitlist â†’' : 'Book Now â†’';
            ctaClass = 'text-orange-600';
            break;
          default:
            if (isFull) {
              borderClass = 'border-2 border-amber-400';
              bgClass = 'bg-amber-50/30';
              badgeHtml = '<span class="text-[10px] font-bold text-white bg-amber-500 px-1.5 py-0.5 rounded uppercase tracking-wide flex items-center gap-1"><span class="iconify" data-icon="lucide:clock" data-width="10"></span>GAME FULL</span>';
              ctaText = 'Join Waitlist â†’';
              ctaClass = 'text-amber-600';
            } else if (isHot) {
              borderClass = 'border-2 border-green-500 shadow-lg';
              bgClass = '';
              badgeHtml = '<span class="text-[10px] font-bold text-white bg-green-600 px-1.5 py-0.5 rounded uppercase tracking-wide">FILLING FAST ðŸ”¥</span>';
              ctaText = 'Book Now â†’';
              ctaClass = 'text-green-600';
            } else {
              borderClass = 'border border-zinc-200';
              bgClass = '';
              const spotsClass = 'text-green-600 border-green-200 bg-green-50';
              badgeHtml = `<span class="text-[10px] font-bold ${spotsClass} border px-1.5 py-0.5 rounded uppercase tracking-wide">${spotsRemaining} SPOTS</span>`;
              ctaText = 'Book Now â†’';
              ctaClass = 'text-green-600';
            }
        }

        // Progress bar color
        const progressColor = isFull ? 'bg-amber-500' : fillPercent >= 70 ? 'bg-orange-500' : 'bg-green-500';

        return `
          <a href="game-details.html?gameId=${encodeURIComponent(game.gameId)}" class="block ${bgClass} bg-white ${borderClass} hover:border-green-500 transition-all group cursor-pointer rounded-lg p-4 relative shadow-sm hover:shadow-md flex flex-col game-card hover:-translate-y-0.5 duration-200 overflow-hidden">
            <div class="absolute inset-0 opacity-[0.02] bg-[url('https://www.transparenttextures.com/patterns/carbon-fibre.png')] pointer-events-none"></div>
            <div class="flex items-center justify-between mb-3">
              <span class="text-[10px] font-bold text-zinc-400 bg-zinc-100 px-1.5 py-0.5 rounded uppercase tracking-wide">
                ${escapeHtml(game.gameId)}
              </span>
              ${badgeHtml}
            </div>
            
            <!-- Time as primary element -->
            <div class="flex items-baseline gap-2 mb-1">
              <span class="text-2xl font-black text-zinc-900 font-display tracking-tight">${escapeHtml(game.time) || 'TBD'}</span>
            </div>
            
            <!-- Title -->
            <h3 class="text-sm font-bold text-zinc-600 mb-2 leading-tight uppercase tracking-wide">
              ${escapeHtml(game.title)}
            </h3>
            
            <!-- Venue -->
            <div class="text-xs text-zinc-500 font-medium mb-1 flex items-center gap-1">
              <span class="iconify text-zinc-400" data-icon="lucide:map-pin" data-width="12"></span>
              ${escapeHtml(venueName)}
            </div>
            
            <!-- Status subline -->
            ${(() => { const sub = getCardSubline(game); return sub ? `<p class="text-[11px] font-bold uppercase tracking-wide ${sub.className} mb-2">${escapeHtml(sub.text)}</p>` : '<div class="mb-2"></div>'; })()}
            
            <!-- Spots progress bar -->
            <div class="mb-3">
              <div class="flex items-center justify-between text-[10px] font-bold uppercase tracking-wide mb-1">
                <span class="text-zinc-400">${filled}/${capacity} Filled</span>
                <span class="${isFull ? 'text-amber-600' : 'text-green-600'}">${isFull ? 'FULL' : spotsRemaining + ' left'}</span>
              </div>
              <div class="w-full h-1.5 bg-zinc-100 rounded-full overflow-hidden">
                <div class="${progressColor} h-full rounded-full transition-all duration-500" style="width: ${fillPercent}%"></div>
              </div>
            </div>
            
            <!-- Footer: price + CTA -->
            <div class="mt-auto flex items-center justify-between pt-2 border-t ${isFull ? 'border-amber-200' : 'border-zinc-100'}">
              <span class="text-sm font-black ${isFull ? 'text-amber-600' : 'text-green-600'}">$${game.price.toFixed(2)}</span>
              <span class="text-[10px] font-bold uppercase tracking-wide ${ctaClass} opacity-0 group-hover:opacity-100 transition-opacity flex items-center gap-1">
                ${ctaText}
              </span>
            </div>
          </a>
        `;
      }

      // Store games data globally for sidebar updates and filtering
      let gamesData = [];
      let allGamesData = [];
      let currentFilter = 'all';
      let currentStatusFilter = 'all';
      let currentSearch = '';
      let selectedCardId = null; // Track selected card across re-renders

      // Get a human-readable subline for a game card based on live status
      function getCardSubline(game) {
        const liveStatus = getGameLiveStatus(game);
        if (liveStatus === 'in-progress') return { text: 'Live now â€” RSVP closed', className: 'text-blue-500' };
        if (liveStatus === 'completed') return { text: 'Completed', className: 'text-zinc-400' };
        if (liveStatus === 'starting-soon') {
          const startTime = parseGameStartTime(game.date, game.time);
          const minsLeft = Math.max(1, Math.round((startTime.getTime() - Date.now()) / 60000));
          return { text: `Starts in ${minsLeft} min`, className: 'text-orange-500' };
        }
        if (game.spotsRemaining === 0) return { text: 'Full â€” waitlist open', className: 'text-amber-500' };
        return null; // No subline for normal bookable games
      }

      // Map venues to regions
      const venueRegions = {
        'Shady Lane Fields': 'east',
        'Shady Lane': 'east',
        'Cesar Chavez Fields': 'south',
        'Cesar Chavez': 'south',
        'Prairie Lane Fields': 'north',
        'Prairie Lane': 'north'
      };

      // Get region for a game
      function getGameRegion(game) {
        const venueName = game.venue?.name || '';
        return venueRegions[venueName] || 'other';
      }

      // Load platform stats for user count badge
      async function loadPlatformStats() {
        try {
          const response = await fetch(`${API_URL}/api/stats/platform`);
          if (!response.ok) throw new Error('Failed to fetch stats');
          
          const stats = await response.json();
          const badge = document.getElementById('player-count-badge');
          
          if (badge) {
            const count = stats.totalParticipants || stats.uniquePlayers || 0;
            // Show count or hide if 0
            if (count > 0) {
              badge.textContent = '+' + count;
              badge.title = `${count} players have joined LaPista`;
            } else {
              // Show "NEW" if no players yet
              badge.textContent = 'NEW';
              badge.title = 'Be one of our first players!';
            }
          }
        } catch (err) {
          console.error('Failed to load platform stats:', err);
          // Fallback - hide the badge or show NEW
          const badge = document.getElementById('player-count-badge');
          if (badge) {
            badge.textContent = 'NEW';
            badge.title = 'Join our community!';
          }
        }
      }

      // Load games from API
      async function loadGames() {
        const loadingEl = document.getElementById('games-loading');
        const errorEl = document.getElementById('games-error');
        const containerEl = document.getElementById('games-container');
        const countEl = document.getElementById('games-count');

        if (!loadingEl || !errorEl || !containerEl || !countEl) {
          console.error('Missing DOM elements:', { loadingEl, errorEl, containerEl, countEl });
          return;
        }

        // Show loading
        loadingEl.classList.remove('hidden');
        errorEl.classList.add('hidden');
        containerEl.classList.add('hidden');

        try {
          const response = await fetch(`${API_URL}/api/games`);
          if (!response.ok) throw new Error(`Failed to fetch games: ${response.status}`);
          
          const games = await response.json();
          
          // Hide loading, show container
          loadingEl.classList.add('hidden');
          containerEl.classList.remove('hidden');
          
          // Note: Count will be updated after filtering to upcoming games only
          
          if (games.length === 0) {
            allGamesData = []; gamesData = []; selectedCardId = null;
            containerEl.innerHTML = `
              <div class="text-center py-12 w-full">
                <div class="w-16 h-16 bg-zinc-100 rounded-full flex items-center justify-center mx-auto mb-4">
                  <span class="iconify text-zinc-400 text-3xl" data-icon="lucide:calendar-x"></span>
                </div>
                <p class="text-zinc-500 font-medium">${typeof I18N !== 'undefined' ? I18N.t('game.noGames', 'No upcoming games scheduled.') : 'No upcoming games scheduled.'}</p>
                <p class="text-zinc-400 text-sm mt-2">${typeof I18N !== 'undefined' ? I18N.t('game.checkBack', 'Check back soon for new games!') : 'Check back soon for new games!'}</p>
              </div>
            `;
            const liveChip = document.getElementById('live-chip');
            if (liveChip) liveChip.classList.add('hidden');
            const mobileCta = document.getElementById('mobile-sticky-cta');
            if (mobileCta) mobileCta.classList.add('translate-y-full');
            return;
          }

          // Sort games by date
          games.sort((a, b) => new Date(a.date) - new Date(b.date));
          
          // Keep games that are still active (open, full, starting-soon, in-progress).
          // In-progress games stay visible with a status badge; completed/cancelled are hidden.
          const upcoming = games.filter(g => {
            const liveStatus = getGameLiveStatus(g);
            return liveStatus !== 'completed' && liveStatus !== 'cancelled';
          });
          
          // Handle no upcoming games
          if (upcoming.length === 0) {
            allGamesData = []; gamesData = []; selectedCardId = null;
            containerEl.innerHTML = `
              <div class="text-center py-12 w-full">
                <div class="w-16 h-16 bg-zinc-100 rounded-full flex items-center justify-center mx-auto mb-4">
                  <span class="iconify text-zinc-400 text-3xl" data-icon="lucide:calendar-x"></span>
                </div>
                <p class="text-zinc-500 font-medium">${typeof I18N !== 'undefined' ? I18N.t('game.noGames', 'No upcoming games scheduled.') : 'No upcoming games scheduled.'}</p>
                <p class="text-zinc-400 text-sm mt-2">${typeof I18N !== 'undefined' ? I18N.t('game.checkBack', 'Check back soon for new games!') : 'Check back soon for new games!'}</p>
              </div>
            `;
            countEl.textContent = `(0 Upcoming)`;
            // Hide live chip â€” no games to be live
            const liveChip = document.getElementById('live-chip');
            if (liveChip) liveChip.classList.add('hidden');
            // Reset mobile CTA to neutral so it doesn't reference a stale game
            const mobileCta = document.getElementById('mobile-sticky-cta');
            if (mobileCta) mobileCta.classList.add('translate-y-full');
            return;
          }

          // Store all upcoming games for filtering
          allGamesData = upcoming;
          gamesData = upcoming;

          // Render with group-by-day layout
          renderFilteredGames();
          
          // Initialize filter functionality (only once â€” avoid duplicate listeners)
          if (!initializeFilters._done) {
            initializeFilters();
            initializeFilters._done = true;
          }

        } catch (err) {
          console.error('Failed to load games:', err);
          loadingEl.classList.add('hidden');
          errorEl.classList.remove('hidden');
          countEl.textContent = '(Error)';
        }
      }

      // Filter and search games
      function filterGames() {
        let filtered = allGamesData;

        // Apply status filter
        if (currentStatusFilter !== 'all') {
          filtered = filtered.filter(game => {
            const ls = getGameLiveStatus(game);
            switch (currentStatusFilter) {
              case 'bookable': return isGameBookable(game);
              case 'live': return ls === 'in-progress' || ls === 'starting-soon';
              case 'full': return game.spotsRemaining === 0 && ls !== 'completed' && ls !== 'cancelled';
              default: return true;
            }
          });
        }

        // Apply region filter
        if (currentFilter !== 'all') {
          filtered = filtered.filter(game => getGameRegion(game) === currentFilter);
        }

        // Apply search filter
        if (currentSearch.trim()) {
          const search = currentSearch.toLowerCase().trim();
          filtered = filtered.filter(game => {
            const title = (game.title || '').toLowerCase();
            const venue = (game.venue?.name || '').toLowerCase();
            const dayOfWeek = (game.dayOfWeek || '').toLowerCase();
            return title.includes(search) || venue.includes(search) || dayOfWeek.includes(search);
          });
        }

        return filtered;
      }

      // Render filtered games â€” grouped by day with date headers
      function renderFilteredGames() {
        const containerEl = document.getElementById('games-container');
        const countEl = document.getElementById('games-count');
        
        const filtered = filterGames();
        gamesData = filtered;

        if (filtered.length === 0) {
          containerEl.innerHTML = `
            <div class="text-center py-12 w-full">
              <div class="w-16 h-16 bg-zinc-100 rounded-full flex items-center justify-center mx-auto mb-4">
                <span class="iconify text-zinc-400 text-3xl" data-icon="lucide:search-x"></span>
              </div>
              <p class="text-zinc-500 font-medium">${typeof I18N !== 'undefined' ? I18N.t('filter.noResults', 'No games match your filters.') : 'No games match your filters.'}</p>
              <p class="text-zinc-400 text-sm mt-2">${typeof I18N !== 'undefined' ? I18N.t('filter.tryAdjusting', 'Try adjusting your search or filter criteria.') : 'Try adjusting your search or filter criteria.'}</p>
            </div>
          `;
          countEl.textContent = `(0 of ${allGamesData.length} Games)`;
          // Hide live chip when no results match
          const liveChip = document.getElementById('live-chip');
          if (liveChip) liveChip.classList.add('hidden');
          return;
        }

        // Find the "hottest" game (most filled, still bookable)
        const hotGame = filtered.reduce((hot, game) => {
          const liveStatus = getGameLiveStatus(game);
          if (liveStatus === 'in-progress') return hot; // Skip in-progress for "hot"
          const capacity = game.capacity || 24;
          const spotsRemaining = Math.max(0, Math.min(game.spotsRemaining, capacity));
          const fillRate = (capacity - spotsRemaining) / capacity;
          const hotCapacity = hot ? (hot.capacity || 24) : 24;
          const hotSpotsRemaining = hot ? Math.max(0, Math.min(hot.spotsRemaining, hotCapacity)) : 0;
          const hotFillRate = hot ? (hotCapacity - hotSpotsRemaining) / hotCapacity : 0;
          return fillRate > hotFillRate && spotsRemaining > 0 ? game : hot;
        }, null);

        // Group games by date
        const today = todayLocal();
        const tomorrow = new Date(today);
        tomorrow.setDate(tomorrow.getDate() + 1);
        
        const groupedByDate = {};
        filtered.forEach(game => {
          const dateKey = gameLocalDate(game.date).toISOString().split('T')[0];
          if (!groupedByDate[dateKey]) groupedByDate[dateKey] = [];
          groupedByDate[dateKey].push(game);
        });

        // Sort date keys chronologically
        const sortedDateKeys = Object.keys(groupedByDate).sort();
        
        let html = '<div class="flex flex-col gap-6 w-full">';
        
        sortedDateKeys.forEach(dateKey => {
          const games = groupedByDate[dateKey];
          const dateObj = new Date(dateKey + 'T12:00:00'); // noon to avoid timezone issues
          
          // Date label: TODAY, TOMORROW, or "SUNDAY, FEB 15"
          let dateLabel;
          let dateSublabel = '';
          const gameDate = new Date(dateObj);
          gameDate.setHours(0, 0, 0, 0);
          
          if (gameDate.getTime() === today.getTime()) {
            dateLabel = 'TODAY';
            dateSublabel = dateObj.toLocaleDateString('en-US', { weekday: 'long', month: 'short', day: 'numeric' });
          } else if (gameDate.getTime() === tomorrow.getTime()) {
            dateLabel = 'TOMORROW';
            dateSublabel = dateObj.toLocaleDateString('en-US', { weekday: 'long', month: 'short', day: 'numeric' });
          } else {
            dateLabel = dateObj.toLocaleDateString('en-US', { weekday: 'long', month: 'short', day: 'numeric' }).toUpperCase();
          }
          
          // Section styling: "TODAY" gets a green accent, only show Live badge if games are actually in-progress
          const isToday = gameDate.getTime() === today.getTime();
          const hasLiveGames = isToday && games.some(g => getGameLiveStatus(g) === 'in-progress');
          const headerBorder = isToday ? 'border-l-4 border-green-500 pl-3' : '';
          const todayBadge = hasLiveGames ? '<span class="ml-2 px-2 py-0.5 bg-blue-500 text-white text-[10px] font-black rounded uppercase tracking-wider animate-pulse">Live</span>' : '';
          
          html += `
            <div class="game-day-group">
              <div class="flex items-center gap-3 mb-3 ${headerBorder}">
                <h3 class="text-sm font-black text-zinc-900 uppercase tracking-widest font-display">${dateLabel}${todayBadge}</h3>
                ${dateSublabel ? `<span class="text-xs text-zinc-400 font-medium">${dateSublabel}</span>` : ''}
                <span class="text-[10px] font-bold text-zinc-500 bg-zinc-100 px-1.5 py-0.5 rounded">${games.length} ${games.length === 1 ? 'game' : 'games'}</span>
                <div class="flex-1 h-px bg-zinc-200"></div>
              </div>
              <!-- Tailwind safelist: grid-cols-1 grid-cols-2 grid-cols-3 sm:grid-cols-2 -->
              <div class="${games.length === 1 ? 'max-w-sm mx-auto' : 'grid grid-cols-1 sm:grid-cols-2 gap-3'}">
          `;
          
          games.forEach(game => {
            const isHot = hotGame && game.gameId === hotGame.gameId;
            html += createGameCard(game, isHot);
          });
          
          html += `
              </div>
            </div>
          `;
        });
        
        html += '</div>';

        containerEl.innerHTML = html;
        containerEl.classList.remove('hidden');
        
        // Track rendered status for auto-refresh diffing
        filtered.forEach(g => { g._lastRenderedStatus = getGameLiveStatus(g); });
        
        countEl.textContent = currentFilter === 'all' && currentStatusFilter === 'all' && !currentSearch 
          ? `(${filtered.length} Games)` 
          : `(${filtered.length} of ${allGamesData.length} Games)`;

        // Update live chip
        const liveCount = filtered.filter(g => getGameLiveStatus(g) === 'in-progress').length;
        const liveChip = document.getElementById('live-chip');
        if (liveChip) {
          if (liveCount > 0) {
            liveChip.textContent = `${liveCount} LIVE NOW`;
            liveChip.classList.remove('hidden');
          } else {
            liveChip.classList.add('hidden');
          }
        }

        // Re-attach click handlers for sidebar
        attachCardHandlers();

        // Restore selected card or default to first
        if (filtered.length > 0) {
          const selectedGame = selectedCardId && filtered.find(g => g.gameId === selectedCardId);
          updateSidebar(selectedGame || filtered[0]);
          // Re-highlight selected card
          if (selectedGame) {
            const cards = document.querySelectorAll('.game-card');
            cards.forEach(c => {
              const href = c.getAttribute('href');
              const cId = new URLSearchParams(href.split('?')[1]).get('gameId');
              if (cId === selectedCardId) c.classList.add('ring-4', 'ring-green-500/30');
            });
          }
        }
      }

      // Initialize filter buttons
      function initializeFilters() {
        const filterBtns = document.querySelectorAll('.filter-btn');
        const statusBtns = document.querySelectorAll('.status-btn');
        const searchInput = document.getElementById('game-search');

        // Status filter chip handlers
        statusBtns.forEach(btn => {
          btn.addEventListener('click', () => {
            statusBtns.forEach(b => {
              b.classList.remove('bg-zinc-900', 'text-white');
              b.classList.add('text-zinc-500');
            });
            btn.classList.remove('text-zinc-500');
            btn.classList.add('bg-zinc-900', 'text-white');
            currentStatusFilter = btn.dataset.status;
            renderFilteredGames();
            syncFiltersToURL();
          });
        });

        // Region filter button click handlers
        filterBtns.forEach(btn => {
          btn.addEventListener('click', () => {
            filterBtns.forEach(b => {
              b.classList.remove('bg-zinc-900', 'text-white');
              b.classList.add('text-zinc-500', 'hover:bg-zinc-200');
            });
            btn.classList.remove('text-zinc-500', 'hover:bg-zinc-200');
            btn.classList.add('bg-zinc-900', 'text-white');
            currentFilter = btn.dataset.region;
            renderFilteredGames();
            syncFiltersToURL();
          });
        });

        // Search input handler with debounce
        let searchTimeout;
        searchInput.addEventListener('input', (e) => {
          clearTimeout(searchTimeout);
          searchTimeout = setTimeout(() => {
            currentSearch = e.target.value;
            renderFilteredGames();
            syncFiltersToURL();
          }, 300);
        });

        // Clear search on Escape
        searchInput.addEventListener('keydown', (e) => {
          if (e.key === 'Escape') {
            searchInput.value = '';
            currentSearch = '';
            renderFilteredGames();
            syncFiltersToURL();
          }
        });
      }

      // Update sidebar with game data
      function updateSidebar(game) {
        const sbTitle = document.getElementById('sidebar-title');
        const sbDate = document.getElementById('sidebar-date');
        const sbVenue = document.getElementById('sidebar-venue');
        const sbTime = document.getElementById('sidebar-time');
        const sbFilled = document.getElementById('sidebar-filled');
        const sbTotal = document.getElementById('sidebar-total');
        const sbProgress = document.getElementById('sidebar-progress');
        const rsvpBtn = document.getElementById('sidebar-rsvp-btn');
        const detailsLink = document.getElementById('sidebar-details-link');
        const liveStatus = getGameLiveStatus(game);
        const bookable = isGameBookable(game);

        if (sbTitle) sbTitle.innerText = game.title;
        if (sbDate) {
          const dateObj = gameLocalDate(game.date);
          sbDate.innerText = dateObj.toLocaleDateString('en-US', {
            month: 'long',
            day: 'numeric',
            year: 'numeric'
          }).toUpperCase();
        }
        
        // Update venue
        if (sbVenue && game.venue) {
          const addressParts = game.venue.address.split(',');
          if (addressParts.length >= 2) {
            sbVenue.innerHTML = `${escapeHtml(addressParts[0])},<br>${escapeHtml(addressParts.slice(1).join(',').trim())}`;
          } else {
            sbVenue.textContent = game.venue.address;
          }
        }
        
        // Update time
        if (sbTime && game.time) {
          sbTime.textContent = game.time;
        }
        
        // Update price
        const sbPrice = document.getElementById('sidebar-price');
        if (sbPrice && game.price != null) {
          sbPrice.textContent = `$${game.price.toFixed(2)}`;
        }
        
        // Update spots (with safeguards to prevent negative values)
        const capacity = game.capacity || 24;
        const spotsRemaining = Math.max(0, Math.min(game.spotsRemaining, capacity));
        const filled = Math.max(0, capacity - spotsRemaining);
        if (sbFilled) sbFilled.innerText = `${filled} FILLED`;
        if (sbTotal) sbTotal.innerText = `${capacity} TOTAL`;
        if (sbProgress) {
          const percentage = Math.max(0, Math.min(100, (filled / capacity) * 100));
          sbProgress.style.width = `${percentage}%`;
        }

        // Update links
        const gameUrl = `game-details.html?gameId=${game.gameId}`;
        if (rsvpBtn) {
          rsvpBtn.href = gameUrl;
          // Update CTA based on live status
          if (liveStatus === 'in-progress') {
            rsvpBtn.innerHTML = '<span class="iconify inline-block mr-2" data-icon="lucide:radio" data-width="1.2"></span>Game In Progress';
            rsvpBtn.className = 'block w-full py-3 bg-blue-500 text-white font-bold uppercase tracking-wide rounded shadow-sm text-sm text-center cursor-default';
          } else if (liveStatus === 'completed') {
            rsvpBtn.innerHTML = '<span class="iconify inline-block mr-2" data-icon="lucide:check-circle-2" data-width="1.2"></span>Game Completed';
            rsvpBtn.className = 'block w-full py-3 bg-zinc-400 text-white font-bold uppercase tracking-wide rounded shadow-sm text-sm text-center cursor-default';
          } else if (game.spotsRemaining === 0) {
            rsvpBtn.innerHTML = '<span class="iconify inline-block mr-2" data-icon="lucide:clock" data-width="1.2"></span>Join Waitlist';
            rsvpBtn.className = 'block w-full py-3 bg-amber-500 hover:bg-amber-600 text-white font-bold uppercase tracking-wide rounded shadow-sm transition-all text-sm text-center';
          } else {
            rsvpBtn.innerHTML = '<span class="iconify inline-block mr-2" data-icon="lucide:ticket" data-width="1.2"></span>Book This Game';
            rsvpBtn.className = 'block w-full py-3 bg-green-600 hover:bg-green-700 text-white font-bold uppercase tracking-wide rounded shadow-sm transition-all text-sm text-center';
          }
        }
        if (detailsLink) detailsLink.href = gameUrl;
        
        // Also update mobile sticky CTA
        const mobileCTAGame = document.getElementById('mobile-cta-game');
        const mobileCTABtn = document.getElementById('mobile-cta-btn');
        if (mobileCTAGame) {
          mobileCTAGame.textContent = game.title;
        }
        // Update mobile subtitle
        const mobileCTASub = document.getElementById('mobile-cta-subtitle');
        if (mobileCTASub) {
          if (liveStatus === 'in-progress') mobileCTASub.textContent = 'Game is live now';
          else if (liveStatus === 'completed') mobileCTASub.textContent = 'Game has ended';
          else if (game.spotsRemaining === 0) mobileCTASub.textContent = 'Game is full â€” join waitlist';
          else mobileCTASub.textContent = 'Tap to book your spot';
        }
        if (mobileCTABtn) {
          mobileCTABtn.href = gameUrl;
          if (liveStatus === 'in-progress') {
            mobileCTABtn.innerHTML = '<span class="iconify" data-icon="lucide:radio" data-width="16"></span>View Live';
            mobileCTABtn.className = 'px-6 py-3 bg-blue-500 text-white font-bold text-sm uppercase rounded-md shadow-sm flex items-center gap-2 flex-shrink-0';
          } else if (!bookable) {
            mobileCTABtn.innerHTML = '<span class="iconify" data-icon="lucide:eye" data-width="16"></span>View';
            mobileCTABtn.className = 'px-6 py-3 bg-zinc-400 text-white font-bold text-sm uppercase rounded-md shadow-sm flex items-center gap-2 flex-shrink-0';
          } else {
            mobileCTABtn.innerHTML = '<span class="iconify" data-icon="lucide:ticket" data-width="16"></span>Book Now';
            mobileCTABtn.className = 'px-6 py-3 bg-green-600 hover:bg-green-700 text-white font-bold text-sm uppercase rounded-md shadow-sm transition-all flex items-center gap-2 flex-shrink-0';
          }
        }
      }

      // Attach click handlers to game cards
      function attachCardHandlers() {
        const cards = document.querySelectorAll('.game-card');

        cards.forEach(card => {
          card.addEventListener('click', (e) => {
            if (window.innerWidth >= 1280) {
              e.preventDefault();
              cards.forEach(c => c.classList.remove('ring-4', 'ring-green-500/30'));
              card.classList.add('ring-4', 'ring-green-500/30');

              // Get gameId from href and find game data
              const href = card.getAttribute('href');
              const gameId = new URLSearchParams(href.split('?')[1]).get('gameId');
              const game = gamesData.find(g => g.gameId === gameId);
              
              if (game) {
                selectedCardId = game.gameId;
                updateSidebar(game);
              }
            }
          });
        });
      }

      // --- Phase 4: URL param sync / restore ---

      /** Push current filter state to URL without page reload */
      function syncFiltersToURL() {
        const params = new URLSearchParams();
        if (currentFilter !== 'all') params.set('region', currentFilter);
        if (currentStatusFilter !== 'all') params.set('status', currentStatusFilter);
        if (currentSearch.trim()) params.set('q', currentSearch.trim());
        const qs = params.toString();
        const url = qs ? `${window.location.pathname}?${qs}${window.location.hash}` : `${window.location.pathname}${window.location.hash}`;
        history.pushState({ region: currentFilter, status: currentStatusFilter, q: currentSearch }, '', url);
      }

      /** Read URL params and apply filter state (called on load and popstate) */
      function restoreFiltersFromURL() {
        const params = new URLSearchParams(window.location.search);
        currentFilter = params.get('region') || 'all';
        currentStatusFilter = params.get('status') || 'all';
        currentSearch = params.get('q') || '';

        // Sync UI chips
        document.querySelectorAll('.filter-btn').forEach(b => {
          b.classList.remove('bg-zinc-900', 'text-white');
          b.classList.add('text-zinc-500', 'hover:bg-zinc-200');
          if (b.dataset.region === currentFilter) {
            b.classList.remove('text-zinc-500', 'hover:bg-zinc-200');
            b.classList.add('bg-zinc-900', 'text-white');
          }
        });
        document.querySelectorAll('.status-btn').forEach(b => {
          b.classList.remove('bg-zinc-900', 'text-white');
          b.classList.add('text-zinc-500');
          if (b.dataset.status === currentStatusFilter) {
            b.classList.remove('text-zinc-500');
            b.classList.add('bg-zinc-900', 'text-white');
          }
        });
        const searchInput = document.getElementById('game-search');
        if (searchInput) searchInput.value = currentSearch;
      }

      // Handle browser back/forward
      window.addEventListener('popstate', () => {
        restoreFiltersFromURL();
        if (allGamesData.length > 0) renderFilteredGames();
      });

      // Load games on page load
      document.addEventListener('DOMContentLoaded', function() {
        // Restore filter state from URL params before loading games
        restoreFiltersFromURL();

        loadGames().catch(err => {
          // Error handled in loadGames
        });
        
        // Auto-refresh: re-render every 60s so status transitions appear live.
        // Only re-fetches from API every 5 minutes; intermediate refreshes just re-render
        // cached data with updated getGameLiveStatus() calculations.
        let _lastApiFetch = Date.now();
        const REFRESH_INTERVAL = 60 * 1000;      // re-render every 60s
        const API_REFRESH_INTERVAL = 5 * 60 * 1000; // re-fetch from API every 5min
        
        setInterval(async () => {
          if (!allGamesData || allGamesData.length === 0) return;
          
          // Always check if any game's computed status changed since last render.
          // This catches every transition (starting-soon â†’ in-progress â†’ completed)
          // even when no games are currently live.
          const needsRerender = allGamesData.some(g => {
            return getGameLiveStatus(g) !== g._lastRenderedStatus;
          });
          
          if (needsRerender || Date.now() - _lastApiFetch > API_REFRESH_INTERVAL) {
            if (Date.now() - _lastApiFetch > API_REFRESH_INTERVAL) {
              // Full refresh from API
              _lastApiFetch = Date.now();
              await loadGames();
            } else {
              // Just re-render with updated status calculations
              renderFilteredGames();
            }
          }
        }, REFRESH_INTERVAL);
        
        // Load platform stats for user count badge
        loadPlatformStats();

        // Fix anchor links - body has overflow:hidden, so we need to scroll the inner container
        document.querySelectorAll('a[href="#schedule"], a[href="index.html#schedule"]').forEach(link => {
          link.addEventListener('click', function(e) {
            e.preventDefault();
            const target = document.getElementById('schedule');
            if (target) {
              target.scrollIntoView({ behavior: 'smooth' });
              // Close mobile menu if open
              const mobileMenuPanel = document.getElementById('mobile-menu-panel');
              const mobileMenuOverlay = document.getElementById('mobile-menu-overlay');
              if (mobileMenuPanel && !mobileMenuPanel.classList.contains('-translate-x-full')) {
                toggleMobileMenu();
              }
            }
          });
        });
      });
    </script>
    
    <!-- Mobile Sticky CTA (only shown on mobile when sidebar isn't visible) -->
    <div id="mobile-sticky-cta" class="lg:hidden fixed bottom-0 left-0 right-0 bg-white border-t border-zinc-200 p-4 z-40 shadow-lg transform translate-y-full transition-transform duration-300">
      <div class="flex items-center justify-between gap-4 max-w-lg mx-auto">
        <div class="flex-1 min-w-0">
          <p id="mobile-cta-game" class="text-sm font-bold text-zinc-900 truncate">Sunday Pickup</p>
          <p id="mobile-cta-subtitle" class="text-xs text-zinc-500">Tap to book your spot</p>
        </div>
        <a id="mobile-cta-btn" href="game-details.html?gameId=LP-001" class="px-6 py-3 bg-green-600 hover:bg-green-700 text-white font-bold text-sm uppercase rounded-md shadow-sm transition-all flex items-center gap-2 flex-shrink-0">
          <span class="iconify" data-icon="lucide:ticket" data-width="16"></span>
          Book Now
        </a>
      </div>
    </div>
    
    <script>
      // Show mobile CTA when user scrolls past hero â€” only if games are available
      const mobileCta = document.getElementById('mobile-sticky-cta');
      const mainContainer = document.getElementById('main-scroll-container');
      if (mobileCta && mainContainer) {
        mainContainer.addEventListener('scroll', () => {
          if (allGamesData && allGamesData.length > 0 && mainContainer.scrollTop > 400) {
            mobileCta.classList.remove('translate-y-full');
          } else {
            mobileCta.classList.add('translate-y-full');
          }
        });
      }
    </script>
    
    <!-- Service Worker Registration -->
    <script>
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          navigator.serviceWorker.register('/sw.js')
            .then(reg => console.log('SW registered'))
            .catch(err => console.log('SW registration failed'));
        });
      }
    </script>
  
</body></html>
